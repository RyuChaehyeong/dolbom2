<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dolbom.mapper.RequestMapper">
    <insert id="insertRequest">
        <selectKey keyProperty="reqId" order="BEFORE" resultType="long">
            SELECT REQ_ID_SEQ.nextval FROM dual
        </selectKey>
        INSERT INTO REQUEST
        (REQ_ID,
         SRVC_ID,
         CUST_ID,
         REQ_TITLE,
         POSTCODE,
         CUST_LOC,
         DETAIL_ADDRESS,
         START_DT,
         END_DT,
         REQ_DTL,
         REQ_PRGR_STAT_CD,
         CREATED_DT,
         CREATED_BY,
         LAST_MODIFIED_DT,
         LAST_MODIFIED_BY)
        VALUES
            (#{reqId},
             #{srvcId},
             #{custId},
             #{reqTitle},
             #{postcode},
             #{custLoc},
             #{detailAddress},
             #{startDt},
             #{endDt},
             #{reqDtl},
             '10',
             sysdate,
             #{createdBy},
             sysdate,
             #{lastModifiedBy})
    </insert>


    <select id="retrieveRequest" resultType="com.dolbom.domain.RequestVO">

    SELECT
         REQ_ID,
         SRVC_ID,
         CUST_ID,
         REQ_TITLE,
         POSTCODE,
         CUST_LOC,
         DETAIL_ADDRESS,
         START_DT,
         END_DT,
         REQ_DTL,
         REQ_PRGR_STAT_CD,
         CREATED_DT,
         CREATED_BY,
         LAST_MODIFIED_DT,
         LAST_MODIFIED_BY
    FROM REQUEST
    WHERE REQ_ID = #{reqId}
    </select>


    <update id="modifyRequest">
        UPDATE REQUEST
            SET REQ_TITLE = #{reqTitle},
                POSTCODE = #{postcode},
                CUST_LOC = #{custLoc},
                DETAIL_ADDRESS = #{detailAddress},
                START_DT = #{startDt},
                END_DT = #{endDt},
                REQ_DTL = #{reqDtl},
                LAST_MODIFIED_DT = sysdate,
                LAST_MODIFIED_BY = #{lastModifiedBy}
            WHERE REQ_ID = #{reqId}
    </update>
</mapper>